<div class="dashboard-container">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">Dashboard</h1>
  
  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
    <!-- Total Users -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center">
      <div class="p-3 rounded-full bg-blue-100 mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
          <circle cx="9" cy="7" r="4" />
          <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
          <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
      </div>
      <div>
        <p class="text-gray-500 text-sm font-medium">Total Users</p>
        <p class="text-2xl font-bold text-gray-800">{{stats.totalUsers}}</p>
        <p class="text-green-500 text-sm">
          <span class="font-bold">+12%</span> from last month
        </p>
      </div>
    </div>

    <!-- Total Departments -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center">
      <div class="p-3 rounded-full bg-green-100 mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h6v6H4z" />
          <path d="M14 4h6v6h-6z" />
          <path d="M4 14h6v6H4z" />
          <path d="M14 14h6v6h-6z" />
        </svg>
      </div>
      <div>
        <p class="text-gray-500 text-sm font-medium">Departments</p>
        <p class="text-2xl font-bold text-gray-800">{{stats.totalDepartments}}</p>
        <p class="text-green-500 text-sm">
          <span class="font-bold">100%</span> active
        </p>
      </div>
    </div>

    <!-- Active Users -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center">
      <div class="p-3 rounded-full bg-yellow-100 mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-600" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
          <circle cx="9" cy="7" r="4" />
          <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
          <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
      </div>
      <div>
        <p class="text-gray-500 text-sm font-medium">Active Users</p>
        <p class="text-2xl font-bold text-gray-800">{{stats.activeUsers}}</p>
        <p class="text-yellow-500 text-sm">
          <span class="font-bold">{{(stats.activeUsers / stats.totalUsers * 100).toFixed(0)}}%</span> of total
        </p>
      </div>
    </div>

    <!-- Pending Approvals -->
    <div class="bg-white rounded-lg shadow p-6 flex items-center">
      <div class="p-3 rounded-full bg-red-100 mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-600" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="8" x2="12" y2="12" />
          <line x1="12" y1="16" x2="12.01" y2="16" />
        </svg>
      </div>
      <div>
        <p class="text-gray-500 text-sm font-medium">Pending</p>
        <p class="text-2xl font-bold text-gray-800">{{stats.pendingApprovals}}</p>
        <p class="text-red-500 text-sm">
          <span class="font-bold">Needs attention</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="bg-white rounded-lg shadow p-6 mb-6">
    <h2 class="text-xl font-semibold text-gray-800 mb-4">Quick Actions</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <button *ngIf="isAdmin()" (click)="openUserModal()"
         class="flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all cursor-pointer text-left">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 mr-3" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
          <circle cx="9" cy="7" r="4" />
          <line x1="19" y1="8" x2="19" y2="14" />
          <line x1="22" y1="11" x2="16" y2="11" />
        </svg>
        <div>
          <p class="font-semibold text-gray-800">Add New User</p>
          <p class="text-sm text-gray-500">Create user account</p>
        </div>
      </button>

      <button *ngIf="isAdmin()" (click)="openDepartmentModal()"
         class="flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 transition-all cursor-pointer text-left">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600 mr-3" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h6v6H4z" />
          <path d="M14 4h6v6h-6z" />
          <path d="M4 14h6v6H4z" />
          <rect x="14" y="14" width="6" height="6" />
        </svg>
        <div>
          <p class="font-semibold text-gray-800">Add New Department</p>
          <p class="text-sm text-gray-500">Create department</p>
        </div>
      </button>

      <button *ngIf="isClient()" (click)="openTicketModal()"
         class="flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-all cursor-pointer text-left">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 mr-3" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z" />
        </svg>
        <div>
          <p class="font-semibold text-gray-800">Create New Ticket</p>
          <p class="text-sm text-gray-500">Submit a support ticket</p>
        </div>
      </button>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="bg-white rounded-lg shadow p-6">
    <h2 class="text-xl font-semibold text-gray-800 mb-4">Recent Activity</h2>
    <div class="space-y-4">
      <div *ngFor="let activity of recentActivities" 
           class="flex items-start pl-4 py-2"
           [ngClass]="{
             'activity-blue': activity.color === 'blue',
             'activity-green': activity.color === 'green',
             'activity-purple': activity.color === 'purple'
           }">
        <div class="flex-1">
          <p class="font-medium text-gray-800">{{ activity.title }}</p>
          <p class="text-sm text-gray-500">{{ activity.description }}</p>
          <p class="text-xs text-gray-400 mt-1">{{ getTimeAgo(activity.timestamp) }}</p>
        </div>
      </div>

      <div *ngIf="recentActivities.length === 0" class="text-center py-4 text-gray-500">
        No recent activity
      </div>
    </div>
  </div>
</div>

<!-- Add User Modal -->
<div *ngIf="showUserModal" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4"
     role="dialog" 
     aria-modal="true">
  <app-add-user-form
    [user]="null"
    [mode]="'add'"
    [loading]="loading"
    (save)="saveUser($event)"
    (cancel)="closeUserModal()">
  </app-add-user-form>
</div>

<!-- Add Department Modal -->
<div *ngIf="showDepartmentModal" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4"
     role="dialog" 
     aria-modal="true">
  <app-add-department-form
    [department]="null"
    [mode]="'add'"
    [loading]="loading"
    (save)="saveDepartment($event)"
    (cancel)="closeDepartmentModal()">
  </app-add-department-form>
</div>

<!-- Add Ticket Modal -->
<div *ngIf="showTicketModal" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4"
     role="dialog" 
     aria-modal="true">
  <app-add-ticket-form
    [ticket]="null"
    [mode]="'add'"
    [loading]="loading"
    (save)="saveTicket($event)"
    (cancel)="closeTicketModal()">
  </app-add-ticket-form>
</div>

<!-- Profile Modal -->
<div *ngIf="showProfileModal" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4"
     role="dialog" 
     aria-modal="true">
  <app-profile-modal
    [userProfile]="userProfile"
    (close)="closeProfileModal()"
    (update)="updateProfile($event)">
  </app-profile-modal>
</div>
